---
type Depth = 2 | 3;
interface Heading { id: string; text: string; depth: Depth; }
interface TocProps { headings?: Heading[]; }

const { headings = [] } = Astro.props as TocProps;
const items = headings.filter(h => h.depth === 2 || h.depth === 3);
const show = items.length >= 2;

// Colocated CSS
const sheet = new URL("./PostToc.css", import.meta.url).toString();
---
{show && (
  <aside class="post__toc" aria-label="On this page">
    <link rel="stylesheet" href={sheet} />
    <ul class="post__toc-list">
      {items.map(h => (
        <li class={`post__toc-item post__toc-item--d${h.depth}`}>
          <a href={`#${h.id}`}>{h.text}</a>
        </li>
      ))}
    </ul>
  </aside>
)}
